// https://github.com/yanatan16/nanoajax
!function(t,e){function n(t){return t&&e.XDomainRequest&&!/MSIE 1/.test(navigator.userAgent)?new XDomainRequest:e.XMLHttpRequest?new XMLHttpRequest:void 0}function o(t,e,n){t[e]=t[e]||n}var r=["responseType","withCredentials","timeout","onprogress"];t.ajax=function(t,a){function s(t,e){return function(){c||(a(void 0===f.status?t:f.status,0===f.status?"Error":f.response||f.responseText||e,f),c=!0)}}var u=t.headers||{},i=t.body,d=t.method||(i?"POST":"GET"),c=!1,f=n(t.cors);f.open(d,t.url,!0);var l=f.onload=s(200);f.onreadystatechange=function(){4===f.readyState&&l()},f.onerror=s(null,"Error"),f.ontimeout=s(null,"Timeout"),f.onabort=s(null,"Abort"),i&&(o(u,"X-Requested-With","XMLHttpRequest"),e.FormData&&i instanceof e.FormData||o(u,"Content-Type","application/x-www-form-urlencoded"));for(var p,m=0,v=r.length;v>m;m++)p=r[m],void 0!==t[p]&&(f[p]=t[p]);for(var p in u)f.setRequestHeader(p,u[p]);return f.send(i),f},e.nanoajax=t}({},function(){return this}());

window.addEventListener("load",function(f){function h(a,c,b){return a.addEventListener(c,b)}function q(a,c){c.forEach(function(b){a.addEventListener(b[0],b[1])})}function m(a,c){if(a.complete)return c();h(a,"load",function(){return c()});h(a,"error",function(a){console.log("error",a)})}function r(a,c,b){var d;return function(){var n=this,g=arguments,e=b&&!d;clearTimeout(d);d=setTimeout(function(){d=null;b||a.apply(n,g)},c);e&&a.apply(n,g)}}function k(a){a.parentElement.style.height=a.clientHeight-
4+"px"}function e(a){var c=this;this.init(a);q(a,[["mouseover",this.hoverEvent.bind(this)],["mouseout",this.hoverEvent.bind(this)],["click",this.clickEvent.bind(this)]]);h(window,"resize",r(function(){return k(this.els.slides[this.focus])},500).bind(this));m(this.els.slides[this.focus].firstElementChild,function(){return setTimeout(function(){k(c.els.slides[0])},300)});this.replay()}f=f.querySelectorAll("[data-jr-gallery]");var t=f.length,u=[];e.prototype.init=function(a){this.timer=a.getAttribute("data-gallery-autoplay");
this.els={lists:a.getElementsByClassName("gallery-list"),slides:a.getElementsByClassName("gallery-focus")[0].children};this.loaded=[this.els.slides[0].dataset.imageId];this.hoverlock=!1;this.focus=0;1<this.els.slides.length&&this.getImgAjax(1)};e.prototype.clickEvent=function(a){var c=a.target.getAttribute("data-go"),b=this.nav();if(c)return a.preventDefault(),isFinite(c)?b.img(c):b[c]()};e.prototype.hoverEvent=function(a){this.hoverLock="mouseover"===a.type};e.prototype.nav=function(){var a=this,
c=this.els,b=c.slides.length;return{img:function(b){a.focus=parseInt(b,10);this.go()},prev:function(){a.focus=(b+a.focus-1)%b;this.go()},next:function(){a.focus=(a.focus+1)%b;this.go()},go:function(){var d=c.slides[a.focus];-1==a.loaded.indexOf(d.dataset.imageId)&&a.getImgAjax(a.focus);m(d.firstElementChild,function(){a.setImg();k(d)});a.focus<b&&-1!=a.loaded.indexOf(a.focus+1)&&a.getImgAjax(a.focus+1)}}};e.prototype.setImg=function(){var a=this.els.lists,c=a.length,b;for(b=0;b<c;b++){var d=a[b],
e=this.focus;d.getElementsByClassName("active")[0].classList.remove("active");d.children[e].classList.add("active");if(a[b].classList.contains("gallery-thumbs")){var d=a[b],g=a[b].children[this.focus],e=d.scrollLeft,p=d.offsetWidth+e,f=g.offsetLeft,g=g.offsetWidth+f;e>f?d.scrollLeft=f:p<g&&(d.scrollLeft-=p-g)}}};e.prototype.getImgAjax=function(a){var c=this,b=this.els.slides[a].dataset.imageId;nanoajax.ajax({url:fileSrc.admin,method:"POST",body:"action=gallery_img_get&id="+b},function(d,e){var g=
c.els.slides[a],f=JSON.parse(e);c.loaded.push(b);g.insertAdjacentHTML("afterbegin",f.img);f.label&&g.insertAdjacentHTML("beforeend",f.label)})};e.prototype.replay=function(){var a=this;"false"!==a.timer&&setTimeout(function(){a.hoverLock||a.nav().next();a.replay()},a.timer)};for(var l=0;l<t;l++)u.push(new e(f[l]))}(document));
